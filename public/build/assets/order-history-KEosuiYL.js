import{j as e,r as p,b as S,S as j,L as k}from"./app-DU2ribiw.js";import{B as c}from"./button-CW_BygfF.js";import{d as C,P as D,a as L,C as O,b as A,c as M}from"./popover-a-v8YfAw.js";import{C as F,A as H}from"./app-layout-u2djOQda.js";import{I as T}from"./input-DRGjZ_Fc.js";import{C as P,S as z,a as I,b as B,c as E,d as N}from"./select-BvX41nsz.js";import{S as Q,a as V}from"./index.module-CKLkyo3k.js";import{F as q}from"./filter-GVI5UFDH.js";import{X as $}from"./x-Bee98Yzc.js";import{f as x}from"./setYear-oS4mZueu.js";import{c as g}from"./currency-convert-C0WIlmuJ.js";import{a as K}from"./date-convert-B8mAUiOy.js";import{A as U,a as X,b as G}from"./accordion-DUn1M_Va.js";/* empty css            */import"./utils-jAU0Cazi.js";import"./createLucideIcon-Du4cilnx.js";import"./differenceInCalendarDays-D_tGss6D.js";import"./index-CqT6Fen0.js";import"./index-CUOMgGua.js";import"./index-dU2Z2OwV.js";import"./index-BFHOmMwe.js";import"./index-8iJUX0HI.js";import"./package-BbxoBmR0.js";import"./index-Dx_FcIva.js";import"./check-BH0nM-99.js";import"./parseISO-ClzP4Ygj.js";function J(){return e.jsx("div",{className:"px-6 py-2",children:e.jsx("div",{className:"flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Order History"}),e.jsx("p",{className:"mt-1 text-sm",children:"Record of Order History"})]})})})}function W({meta:s,handlePageChange:a}){return e.jsx("div",{children:s.last_page>1&&e.jsxs("div",{className:"flex items-center justify-between border-t px-4 py-3",children:[e.jsx("div",{className:"flex items-center text-sm text-gray-700"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>a(s.current_page-1),disabled:s.current_page===1,className:"flex items-center gap-1",children:[e.jsx(C,{className:"h-4 w-4"}),"Previous"]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[s.current_page>3&&e.jsxs(e.Fragment,{children:[e.jsx(c,{variant:s.current_page===1?"default":"outline",size:"sm",onClick:()=>a(1),className:"min-w-[40px]",children:"1"}),s.current_page>4&&e.jsx("span",{className:"px-2 text-gray-500",children:"..."})]}),Array.from({length:Math.min(5,s.last_page)},(o,r)=>{let t;return s.last_page<=5||s.current_page<=3?t=r+1:s.current_page>=s.last_page-2?t=s.last_page-4+r:t=s.current_page-2+r,t<1||t>s.last_page||s.current_page>3&&t===1||s.current_page<s.last_page-2&&t===s.last_page?null:e.jsx(c,{variant:t===s.current_page?"default":"outline",size:"sm",onClick:()=>a(t),className:"min-w-[40px]",children:t},t)}),s.current_page<s.last_page-2&&e.jsxs(e.Fragment,{children:[s.current_page<s.last_page-3&&e.jsx("span",{className:"px-2 text-gray-500",children:"..."}),e.jsx(c,{variant:s.last_page===s.current_page?"default":"outline",size:"sm",onClick:()=>a(s.last_page),className:"min-w-[40px]",children:s.last_page})]})]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>a(s.current_page+1),disabled:s.current_page===s.last_page,className:"flex items-center gap-1",children:["Next",e.jsx(F,{className:"h-4 w-4"})]})]})]})})}function Y({handleApplyDateFilter:s,clearAllFilters:a,querySearch:o,dateRange:r,setQuerySearch:t,hasActiveFilters:m,selectedStatus:n,setShowFilters:l,showFilters:i,setSelectedStatus:d,setDateRange:f}){return e.jsx("div",{className:"px-6 py-2",children:e.jsxs("div",{className:"bordershadow-sm mb-6 rounded-lg",children:[e.jsx("div",{className:"border-b p-4",children:e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"relative max-w-md flex-1",children:[e.jsx(Q,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 transform"}),e.jsx(T,{type:"text",placeholder:"Search items...",value:o,onChange:u=>t(u.target.value),className:"w-full rounded-md border py-2 pr-4 pl-9 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-500 focus:outline-none"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[m&&e.jsxs("span",{className:"rounded px-2 py-1 text-xs",children:[Object.values({search:o,status:n}).filter(Boolean).length,"filter(s) active"]}),e.jsxs(c,{variant:"outline",onClick:()=>l(!i),className:"inline-flex items-center rounded-md border px-3 py-2 text-sm font-medium transition-colors",children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),"Filters",e.jsx(P,{className:`ml-1 h-4 w-4 transition-transform ${i?"rotate-180":""}`})]}),m&&e.jsxs("button",{onClick:a,className:"0 inline-flex items-center rounded-md border px-3 py-2 text-sm font-medium text-red-700 transition-colors",children:[e.jsx($,{className:"mr-2 h-4 w-4"}),"Clear"]})]})]})}),i&&e.jsx("div",{className:"border-t p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Status"}),e.jsxs(z,{value:n,onValueChange:d,children:[e.jsx(I,{children:e.jsx(B,{placeholder:"pilih status order"})}),e.jsxs(E,{children:[e.jsx(N,{value:"completed",children:"Completed"}),e.jsx(N,{value:"processing",children:"Processing"}),e.jsx(N,{value:"cancelled",children:"cancelled"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Pilih Tanggal"}),e.jsxs(D,{children:[e.jsx(L,{asChild:!0,children:e.jsxs(c,{variant:"outline",className:"min-w-[240px] justify-start text-left font-normal",children:[e.jsx(O,{className:"mr-2 h-4 w-4"}),r!=null&&r.from?r.to?e.jsxs(e.Fragment,{children:[x(r.from,"LLL dd, y")," - ",x(r.to,"LLL dd, y")]}):x(r.from,"LLL dd, y"):e.jsx("span",{children:"Pick a date range"})]})}),e.jsx(A,{className:"w-auto p-0",align:"start",children:e.jsx(M,{mode:"range",defaultMonth:r==null?void 0:r.from,selected:r,onSelect:u=>{f(u||{from:void 0,to:void 0})},numberOfMonths:2,required:!1})})]})]}),e.jsx("div",{children:e.jsx(c,{className:"mt-6 w-[150px]",onClick:s,disabled:!r.from||!r.to,children:"Terapkan Tanggal"})})]})})]})})}function Z({orderHistories:s}){const[a,o]=p.useState(null);function r(t,m,n){return a!==n?null:e.jsx("tr",{className:"gap-5 bg-muted/20",children:e.jsx("td",{className:"d-block px-4 py-4",colSpan:8,children:e.jsx(U,{type:"single",collapsible:!0,className:"w-full",value:n,children:e.jsx(X,{value:n,children:e.jsx(G,{className:"accordion-content flex flex-col p-0 text-balance",children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{className:"mx-5 rounded-[100px] border text-left",children:e.jsxs("tr",{className:"text-sm font-semibold",children:[e.jsx("th",{className:"px-2 py-2 text-center",children:"No"}),e.jsx("th",{className:"px-2 py-2",children:"Item Name"}),e.jsx("th",{className:"px-2 py-2",children:"SKU"}),e.jsx("th",{className:"px-2 py-2",children:"Variant Name"}),e.jsx("th",{className:"px-2 py-2 text-center",children:"Quantity"}),e.jsx("th",{className:"px-2 py-2",children:"Price"})]})}),e.jsx("tbody",{children:m.map((l,i)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2 text-center",children:i+1}),e.jsx("td",{className:"px-2 py-2",children:l.item_name}),e.jsx("td",{className:"px-2 py-2",children:l.sku}),e.jsx("td",{className:"px-2 py-2",children:l.variant_name}),e.jsxs("td",{className:"px-2 py-2 text-center",children:["x ",l.quantity]}),e.jsx("td",{className:"px-2 py-2 text-right",children:g(l.price_at_sale)})]},l.sku))}),e.jsxs("tfoot",{className:"text-xs",children:[e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{colSpan:6,className:"pt-3 pr-4 text-right font-semibold",children:"Total"}),e.jsx("td",{className:"py-1 pt-3 pr-2 text-right",children:g(t.total_amount)})]}),t.discount>0&&e.jsxs("tr",{className:"align-top",children:[e.jsx("td",{colSpan:6,className:"py-1 pr-4 text-right font-semibold",children:"Discount"}),e.jsx("td",{className:"space-y-1 py-1 pr-2 text-right text-destructive-foreground",children:e.jsxs("div",{children:[" ","(",t.discount,"%) ",e.jsx("span",{className:"text-muted-foreground",children:"- "})]})})]}),e.jsxs("tr",{children:[e.jsx("td",{colSpan:6,className:"py-1 pr-4 text-right font-semibold",children:"Final Amount"}),e.jsx("td",{className:"py-1 pr-2 text-right",children:g(t.final_amount)})]})]})]})})})})})})}return e.jsx("div",{className:"px-6 py-2",children:e.jsx("div",{className:"rounded-lg border",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"border-b",children:e.jsxs("tr",{className:"text-center",children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium tracking-wider uppercase",children:"Order Id"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium tracking-wider uppercase",children:"Cashier Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium tracking-wider uppercase",children:"Buyer Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium tracking-wider uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium tracking-wider uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium tracking-wider uppercase",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y",children:s.map(t=>e.jsxs(S.Fragment,{children:[e.jsxs("tr",{onClick:()=>o(a===t.id?null:t.id),className:"cursor-pointer transition duration-700 ease-out hover:bg-accent-foreground hover:text-background",children:[e.jsx("td",{className:"px-4 py-4",children:e.jsx("span",{className:"text-sm font-medium",children:t.id})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("span",{className:"text-sm font-medium",children:t.cashier_name})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("span",{className:"text-sm font-medium",children:t.buyer_name})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("span",{className:"text-sm",children:t.status})}),e.jsx("td",{children:e.jsx("span",{className:"text-sm",children:K(t.created_at)})}),e.jsx("td",{className:"px-3",children:e.jsx(c,{className:"w-full bg-blue-600 text-white hover:bg-blue-700 disabled:bg-gray-600",onClick:()=>j.get(route("menu",{orderId:t.id})),disabled:t.status==="completed",children:t.status==="completed"?"Done":"Continue"})})]}),r(t,t.details,t.id)]},t.id))})]})})})})}function Se({order_histories:s,filters:a}){const o=[{title:"Order History",href:"/sales"}],[r,t]=p.useState(a.search||""),[m,n]=p.useState(!1),[l,i]=p.useState({from:a!=null&&a.startDate?new Date(a.startDate):void 0,to:a!=null&&a.endDate?new Date(a.endDate):void 0}),[d,f]=p.useState(a.status||""),[u]=V(r,300),y=h=>{const w={search:r,status:d,startDate:l.from?x(l.from,"yyyy-MM-dd"):"",endDate:l.to?x(l.to,"yyyy-MM-dd"):"",page:h};j.get(route("order.histories"),w,{preserveState:!0,preserveScroll:!0,replace:!0})},v=()=>{if(!l.from||!l.to){alert("Silakan pilih tanggal mulai dan akhir.");return}const h={search:r,status:d,startDate:x(l.from,"yyyy-MM-dd"),endDate:x(l.to,"yyyy-MM-dd"),page:1};j.get(route("order.histories"),h,{preserveState:!0,preserveScroll:!0,replace:!0})},b=()=>{t(""),f(""),i({from:void 0,to:void 0}),j.get(route("order.histories"),{search:"",stock_condition:"",startDate:"",endDate:"",page:1})};p.useEffect(()=>{const h={search:r,status:d};j.get(route("order.histories"),h,{preserveState:!0,preserveScroll:!0,replace:!0})},[u,d]);const _=d||r;return e.jsxs(H,{breadcrumbs:o,children:[e.jsx(k,{title:"Order History"}),e.jsx(J,{}),e.jsx(Y,{clearAllFilters:b,setDateRange:i,handleApplyDateFilter:v,selectedStatus:d,setSelectedStatus:f,setQuerySearch:t,setShowFilters:n,querySearch:r,showFilters:m,hasActiveFilters:_,dateRange:l}),e.jsx(Z,{orderHistories:s.data}),e.jsx(W,{meta:s.meta,handlePageChange:y})]})}export{Se as default};
