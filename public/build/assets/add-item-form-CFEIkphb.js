import{j as e,r as N,m as U}from"./app-DU2ribiw.js";import{n as m,g as k}from"./number-format-C9-KG7aE.js";import{t as g}from"./index-Dx_FcIva.js";import{L as o}from"./label-_NFcsuFK.js";import{P as K}from"./plus-2zmbfM6P.js";import{T as P}from"./trash-2-C-RqbMgP.js";import{S as h}from"./input-DFj5_SXz.js";import{H as y}from"./button-B7FeFBqm.js";import w from"./add-item-basic-information-BCvGR5jW.js";/* empty css            */import"./index-CqT6Fen0.js";import"./index-DUB01RiQ.js";import"./index-dU2Z2OwV.js";import"./utils-jAU0Cazi.js";import"./createLucideIcon-Du4cilnx.js";import"./disabled-DZY9BukL.js";import"./render-Bk8bJzw1.js";import"./use-sync-refs-B6MvusC4.js";import"./use-disposables-DuyS72Pr.js";import"./input-DRGjZ_Fc.js";import"./select-BvX41nsz.js";import"./index-CUOMgGua.js";import"./index-BFHOmMwe.js";import"./check-BH0nM-99.js";function I(){return e.jsx("div",{className:"flex items-center justify-start space-x-3 pt-6",children:e.jsx("button",{type:"submit",className:"rounded-md border border-transparent bg-blue-600 px-6 py-2 text-sm font-medium text-white transition-colors hover:bg-blue-700",children:"Tambah Item"})})}function $({formData:i,setData:r}){const[c,u]=N.useState({name:"",sku:"",additional_price:0,minimum_stock:0,stock:0}),[t,x]=N.useState({}),[d,b]=N.useState(!1),l=(s,n)=>{u(a=>({...a,[s]:n})),t[s]&&x(a=>({...a,[s]:void 0}))},_=()=>{const s={},{name:n,sku:a,additional_price:p,minimum_stock:v,stock:f}=c;return!n||n.trim()===""?s.name="Variant name is required":n.length<2?s.name="Variant name must be at least 2 characters":n.length>100&&(s.name="Variant name must not exceed 100 characters"),!a||a.trim()===""?s.sku="SKU is required":a.length<3?s.sku="SKU must be at least 3 characters":a.length>50?s.sku="SKU must not exceed 50 characters":/^[A-Za-z0-9-_]+$/.test(a)||(s.sku="SKU can only contain letters, numbers, hyphens, and underscores"),i.variants&&Array.isArray(i.variants)&&i.variants.map(V=>V.sku.toLowerCase()).includes(a.toLowerCase())&&(s.sku="SKU already exists. Please use a unique SKU"),Number(p)<0?s.additional_price="Additional price cannot be negative":Number(p)>999999999&&(s.additional_price="Additional price is too large"),Number(f)<0?s.stock="Stock cannot be negative":Number(f)>999999&&(s.stock="Stock value is too large"),Number(v)<0?s.minimum_stock="Minimum stock cannot be negative":Number(v)>999999&&(s.minimum_stock="Minimum stock value is too large"),Number(v)>Number(f)&&(s.minimum_stock="Minimum stock cannot be greater than current stock"),s},S=async()=>{b(!0);try{const s=_();if(Object.keys(s).length>0){x(s),g.error("Please fix the validation errors before adding the variant");return}const n={...c,name:c.name.trim(),sku:c.sku.trim().toUpperCase()};r(a=>({...a,variants:[...a.variants,n]})),g.success("Variant successfully added"),u({name:"",sku:"",additional_price:0,minimum_stock:0,stock:0}),x({})}catch{g.error("Failed to add variant. Please try again.")}finally{b(!1)}},C=s=>{if(i.variants&&Array.isArray(i.variants)){const n=i.variants.filter((a,p)=>p!==s);r(a=>({...a,variants:n})),g.success("Variant removed successfully")}},j=s=>`w-full rounded-md border px-3 py-2 text-sm focus:border-transparent focus:ring-2 focus:outline-none ${t[s]?"border-red-500 focus:ring-red-500":"focus:ring-blue-500"}`,A=()=>`w-full rounded-md border py-2 pr-3 pl-8 text-sm focus:border-transparent focus:ring-2 focus:outline-none ${t.additional_price?"border-red-500 focus:ring-red-500":"focus:ring-blue-500"}`;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-lg border",children:[e.jsxs("div",{className:"border-b px-6 py-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Product Variant"}),e.jsx("p",{className:"mt-1 text-sm",children:"Add Product Variant"})]}),e.jsxs("div",{className:"space-y-4 p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsxs(o,{className:"mb-2 block text-sm font-medium",children:["Variant Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(h,{type:"text",value:c.name,onChange:s=>l("name",s.target.value),className:j("name"),placeholder:"Enter variant name",maxLength:100}),t.name&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.name})]}),e.jsxs("div",{children:[e.jsxs(o,{className:"mb-2 block text-sm font-medium",children:["Additional Price ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute top-1/2 left-3 -translate-y-1/2 transform text-sm",children:"Rp"}),e.jsx(h,{type:"text",inputMode:"numeric",value:m(Number(c.additional_price)),onChange:s=>l("additional_price",k(s.target.value)),className:A(),placeholder:"0"})]}),t.additional_price&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.additional_price})]}),e.jsxs("div",{children:[e.jsx(o,{className:"mb-2 block text-sm font-medium",children:"Stock"}),e.jsx(h,{type:"text",inputMode:"numeric",value:m(Number(c.stock)),onChange:s=>l("stock",k(s.target.value)),className:j("stock"),placeholder:"0"}),t.stock&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.stock})]}),e.jsxs("div",{children:[e.jsx(o,{className:"mb-2 block text-sm font-medium",children:"Minimum Stock"}),e.jsx(h,{type:"text",inputMode:"numeric",value:m(Number(c.minimum_stock)),onChange:s=>l("minimum_stock",k(s.target.value)),className:j("minimum_stock"),placeholder:"0"}),t.minimum_stock&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.minimum_stock})]}),e.jsxs("div",{children:[e.jsxs(o,{className:"mb-2 block text-sm font-medium",children:["SKU ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"flex",children:e.jsx(h,{type:"text",value:c.sku,onChange:s=>l("sku",s.target.value),className:`flex-1 rounded-l-md border px-3 py-2 text-sm focus:border-transparent focus:ring-2 focus:outline-none ${t.sku?"border-red-500 focus:ring-red-500":"focus:ring-blue-500"}`,placeholder:"Product SKU",maxLength:50})}),t.sku&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.sku})]})]}),e.jsx("div",{children:e.jsxs(y,{type:"button",onClick:S,disabled:d,className:`flex items-center gap-1 rounded-md border px-6 py-2 text-sm font-medium transition-colors ${d?"cursor-not-allowed bg-gray-100 text-gray-400":"hover:bg-gray-50 active:bg-gray-100"}`,children:[e.jsx(K,{className:"h-4 w-4"}),d?"Adding...":"Add Variant"]})})]})]}),i.variants&&Array.isArray(i.variants)&&i.variants.length>0&&e.jsxs("div",{className:"rounded-lg border",children:[e.jsxs("div",{className:"border-b px-6 py-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Added Variants"}),e.jsxs("p",{className:"mt-1 text-sm",children:[i.variants.length," variant",i.variants.length>1?"s":""," added"]})]}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"space-y-4",children:i.variants.map((s,n)=>e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"grid flex-1 grid-cols-1 gap-4 md:grid-cols-5",children:[e.jsxs("div",{children:[e.jsx(o,{className:"text-xs font-medium",children:"Name"}),e.jsx("p",{className:"text-sm font-medium",children:s.name})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-xs font-medium",children:"SKU"}),e.jsx("p",{className:"font-mono text-sm",children:s.sku})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-xs font-medium",children:"Additional Price"}),e.jsxs("p",{className:"text-sm",children:["Rp ",m(Number(s.additional_price))]})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-xs font-medium",children:"Stock"}),e.jsx("p",{className:"text-sm",children:m(Number(s.stock))})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-xs font-medium",children:"Min Stock"}),e.jsx("p",{className:"text-sm",children:m(Number(s.minimum_stock))})]})]}),e.jsx("div",{className:"ml-4",children:e.jsx(y,{type:"button",onClick:()=>C(n),className:"flex items-center justify-center rounded-md border border-red-200 p-2 text-red-600 transition-colors hover:border-red-300 hover:bg-red-50",title:"Remove variant",children:e.jsx(P,{className:"h-4 w-4"})})})]},`${s.sku}-${n}`))})})]})]})}function ie({categories:i,item:r}){const{data:c,setData:u,post:t,reset:x,errors:d}=U({name:(r==null?void 0:r.name)||"",category_id:(r==null?void 0:r.category_id)||"",description:(r==null?void 0:r.description)||"",purchase_price:(r==null?void 0:r.purchase_price)||0,selling_price:(r==null?void 0:r.selling_price)||0,brand:(r==null?void 0:r.brand)||"",variants:(r==null?void 0:r.variants)||[]}),b=l=>{l.preventDefault(),t(route("item.store"),{onSuccess:()=>{x("name","category_id","description","purchase_price","selling_price","brand","variants")},onError:()=>{console.log(d)}})};return e.jsx("div",{className:"px-6 py-6",children:e.jsx("div",{className:"mx-auto",children:e.jsxs("form",{onSubmit:b,children:[e.jsx("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:e.jsxs("div",{className:"space-y-6 lg:col-span-2",children:[e.jsx(w,{errors:d,formData:c,categories:i,setData:u}),e.jsx($,{formData:c,setData:u})]})}),e.jsx(I,{})]})})})}export{ie as default};
