import{j as e,r as f,m as I}from"./app-BSuvoTbS.js";import{n as d,g as k}from"./number-format-C9-KG7aE.js";import{t as g}from"./index-7cjgg6I-.js";import{B as y}from"./button-B6cZ_Vso.js";import{I as h}from"./input-Co4OhKCu.js";import{L as l}from"./label-CriFCr2L.js";import{P as U}from"./plus-Dvb-4iQ1.js";import{T as K}from"./trash-2-BS0vOb9V.js";import P from"./add-item-basic-information-BpQ4NUyp.js";/* empty css            */import"./index-muPcKthH.js";import"./utils-jAU0Cazi.js";import"./index-0zabl2EX.js";import"./index-B3pNf6Lt.js";import"./createLucideIcon-ZpcOBMUu.js";import"./select-3uS57-AO.js";import"./index-o8OQ9nSE.js";import"./index-BIqVCQeL.js";import"./check-eyUfg_75.js";function w(){return e.jsx("div",{className:"flex items-center justify-start space-x-3 pt-6",children:e.jsx("button",{type:"submit",className:"rounded-md border border-transparent bg-blue-600 px-6 py-2 text-sm font-medium text-white transition-colors hover:bg-blue-700",children:"Tambah Item"})})}function M({formData:i,setData:a}){const[c,m]=f.useState({name:"",sku:"",additional_price:0,minimum_stock:0,stock:0}),[t,u]=f.useState({}),[x,b]=f.useState(!1),o=(s,n)=>{m(r=>({...r,[s]:n})),t[s]&&u(r=>({...r,[s]:void 0}))},_=()=>{const s={},{name:n,sku:r,additional_price:p,minimum_stock:j,stock:N}=c;return!n||n.trim()===""?s.name="Variant name is required":n.length<2?s.name="Variant name must be at least 2 characters":n.length>100&&(s.name="Variant name must not exceed 100 characters"),!r||r.trim()===""?s.sku="SKU is required":r.length<3?s.sku="SKU must be at least 3 characters":r.length>50?s.sku="SKU must not exceed 50 characters":/^[A-Za-z0-9-_]+$/.test(r)||(s.sku="SKU can only contain letters, numbers, hyphens, and underscores"),i.variants&&Array.isArray(i.variants)&&i.variants.map(V=>V.sku.toLowerCase()).includes(r.toLowerCase())&&(s.sku="SKU already exists. Please use a unique SKU"),Number(p)<0?s.additional_price="Additional price cannot be negative":Number(p)>999999999&&(s.additional_price="Additional price is too large"),Number(N)<0?s.stock="Stock cannot be negative":Number(N)>999999&&(s.stock="Stock value is too large"),Number(j)<0?s.minimum_stock="Minimum stock cannot be negative":Number(j)>999999&&(s.minimum_stock="Minimum stock value is too large"),Number(j)>Number(N)&&(s.minimum_stock="Minimum stock cannot be greater than current stock"),s},C=async()=>{b(!0);try{const s=_();if(Object.keys(s).length>0){u(s),g.error("Please fix the validation errors before adding the variant");return}const n={...c,name:c.name.trim(),sku:c.sku.trim().toUpperCase()};a(r=>({...r,variants:[...r.variants,n]})),g.success("Variant successfully added"),m({name:"",sku:"",additional_price:0,minimum_stock:0,stock:0}),u({})}catch{g.error("Failed to add variant. Please try again.")}finally{b(!1)}},S=s=>{if(i.variants&&Array.isArray(i.variants)){const n=i.variants.filter((r,p)=>p!==s);a(r=>({...r,variants:n})),g.success("Variant removed successfully")}},v=s=>`w-full rounded-md border px-3 py-2 text-sm focus:border-transparent focus:ring-2 focus:outline-none ${t[s]?"border-red-500 focus:ring-red-500":"focus:ring-blue-500"}`,A=()=>`w-full rounded-md border py-2 pr-3 pl-8 text-sm focus:border-transparent focus:ring-2 focus:outline-none ${t.additional_price?"border-red-500 focus:ring-red-500":"focus:ring-blue-500"}`;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-lg border",children:[e.jsxs("div",{className:"border-b px-6 py-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Product Variant"}),e.jsx("p",{className:"mt-1 text-sm",children:"Add Product Variant"})]}),e.jsxs("div",{className:"space-y-4 p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsxs(l,{className:"mb-2 block text-sm font-medium",children:["Variant Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(h,{type:"text",value:c.name,onChange:s=>o("name",s.target.value),className:v("name"),placeholder:"Enter variant name",maxLength:100}),t.name&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.name})]}),e.jsxs("div",{children:[e.jsxs(l,{className:"mb-2 block text-sm font-medium",children:["Additional Price ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute top-1/2 left-3 -translate-y-1/2 transform text-sm",children:"Rp"}),e.jsx(h,{type:"text",inputMode:"numeric",value:d(Number(c.additional_price)),onChange:s=>o("additional_price",k(s.target.value)),className:A(),placeholder:"0"})]}),t.additional_price&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.additional_price})]}),e.jsxs("div",{children:[e.jsx(l,{className:"mb-2 block text-sm font-medium",children:"Stock"}),e.jsx(h,{type:"text",inputMode:"numeric",value:d(Number(c.stock)),onChange:s=>o("stock",k(s.target.value)),className:v("stock"),placeholder:"0"}),t.stock&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.stock})]}),e.jsxs("div",{children:[e.jsx(l,{className:"mb-2 block text-sm font-medium",children:"Minimum Stock"}),e.jsx(h,{type:"text",inputMode:"numeric",value:d(Number(c.minimum_stock)),onChange:s=>o("minimum_stock",k(s.target.value)),className:v("minimum_stock"),placeholder:"0"}),t.minimum_stock&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.minimum_stock})]}),e.jsxs("div",{children:[e.jsxs(l,{className:"mb-2 block text-sm font-medium",children:["SKU ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"flex",children:e.jsx(h,{type:"text",value:c.sku,onChange:s=>o("sku",s.target.value),className:`flex-1 rounded-l-md border px-3 py-2 text-sm focus:border-transparent focus:ring-2 focus:outline-none ${t.sku?"border-red-500 focus:ring-red-500":"focus:ring-blue-500"}`,placeholder:"Product SKU",maxLength:50})}),t.sku&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:t.sku})]})]}),e.jsx("div",{children:e.jsxs(y,{type:"button",onClick:C,disabled:x,variant:"outline",className:"flex items-center gap-1",children:[e.jsx(U,{className:"h-4 w-4"}),x?"Adding...":"Add Variant"]})})]})]}),i.variants&&Array.isArray(i.variants)&&i.variants.length>0&&e.jsxs("div",{className:"rounded-lg border",children:[e.jsxs("div",{className:"border-b px-6 py-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Added Variants"}),e.jsxs("p",{className:"mt-1 text-sm",children:[i.variants.length," variant",i.variants.length>1?"s":""," added"]})]}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"space-y-4",children:i.variants.map((s,n)=>e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"grid flex-1 grid-cols-1 gap-4 md:grid-cols-5",children:[e.jsxs("div",{children:[e.jsx(l,{className:"text-xs font-medium",children:"Name"}),e.jsx("p",{className:"text-sm font-medium",children:s.name})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-xs font-medium",children:"SKU"}),e.jsx("p",{className:"font-mono text-sm",children:s.sku})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-xs font-medium",children:"Additional Price"}),e.jsxs("p",{className:"text-sm",children:["Rp ",d(Number(s.additional_price))]})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-xs font-medium",children:"Stock"}),e.jsx("p",{className:"text-sm",children:d(Number(s.stock))})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-xs font-medium",children:"Min Stock"}),e.jsx("p",{className:"text-sm",children:d(Number(s.minimum_stock))})]})]}),e.jsx("div",{className:"ml-4",children:e.jsx(y,{type:"button",onClick:()=>S(n),variant:"outline",size:"icon",className:"border-red-200 text-red-600 hover:border-red-300 hover:bg-red-50",title:"Remove variant",children:e.jsx(K,{className:"h-4 w-4"})})})]},`${s.sku}-${n}`))})})]})]})}function se({categories:i,item:a}){const{data:c,setData:m,post:t,reset:u,errors:x}=I({name:(a==null?void 0:a.name)||"",category_id:(a==null?void 0:a.category_id)||"",description:(a==null?void 0:a.description)||"",purchase_price:(a==null?void 0:a.purchase_price)||0,selling_price:(a==null?void 0:a.selling_price)||0,brand:(a==null?void 0:a.brand)||"",variants:(a==null?void 0:a.variants)||[]}),b=o=>{o.preventDefault(),t(route("item.store"),{onSuccess:()=>{u("name","category_id","description","purchase_price","selling_price","brand","variants")},onError:()=>{console.log(x)}})};return e.jsx("div",{className:"px-6 py-6",children:e.jsx("div",{className:"mx-auto",children:e.jsxs("form",{onSubmit:b,children:[e.jsx("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:e.jsxs("div",{className:"space-y-6 lg:col-span-2",children:[e.jsx(P,{errors:x,formData:c,categories:i,setData:m}),e.jsx(M,{formData:c,setData:m})]})}),e.jsx(w,{})]})})})}export{se as default};
